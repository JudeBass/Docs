<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Create A Bootable MicroSD Card From Sources - UDOO Quad/Dual Docs</title>
    <meta name="description" content="UDOO Board Documentation" />
    <meta name="author" content="UDOO Team">
    <meta charset="UTF-8">
    <link rel="icon" href="http://www.udoo.org/wp-content/uploads/2014/12/logo_udoo_32.ico" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='//fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme.min.css' rel='stylesheet' type='text/css'><link href='../themes/daux/css/theme-navy.min.css' rel='stylesheet' type='text/css'><link href='../themes/daux/css/udoo.css' rel='stylesheet' type='text/css'>
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="google-site-verification" content="GlKlGkbxuWQ3LNWx0akLYkqoWLrtF5b0ug9UpGadSuc" />
    <meta name="google-site-verification" content="vL1Qo6JWKZBq6fzVJLJhbyqHya1TBhZd78OJDA-Qe1s" />
</head>
<body class="">
    
    <a href="https://github.com/UDOOboard/Docs" target="_blank" id="github-ribbon" class="hidden-print"><img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
<div class="container-fluid fluid-height wrapper">
    <div class="navbar navbar-static-top hidden-print">
        <div class="container-fluid">
            <a class="udoologo pull-left" href="../index.html">
		<img src="http://www.udoo.org/docs/img/logo_docs.png"> <span>Docs</span>
		<a class="btn btn-lg button_docs pull-right" href="http://www.udoo.org/docs-neo/">UDOO Neo Docs</a>
</a>
        </div>
    </div>
    <div class="row columns content">
        <div class="left-column article-tree col-sm-3 hidden-print">
            <!-- For Mobile -->
            <div class="responsive-collapse">
                <button type="button" class="btn btn-sidebar" id="menu-spinner-button">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div id="sub-nav-collapse" class="sub-nav-collapse">
                <!-- Navigation -->
                <ul class='nav nav-list'><li class=''><a href="#" class="aj-nav folder">Introduction</a><ul class='nav nav-list'><li class=''><a href="../Introduction/Introduction.html">Introduction</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Getting Started</a><ul class='nav nav-list'><li class=''><a href="../Getting_Started/Very_First_Start.html">Very First Start</a></li><li class=''><a href="../Getting_Started/Create_A_Bootable_MicroSD_card_for_UDOO.html">Create A Bootable MicroSD card for UDOO</a></li><li class=''><a href="../Getting_Started/UDOO_Configuration_Tool.html">UDOO Configuration Tool</a></li></ul></li><li class='open'><a href="#" class="aj-nav folder">Advanced Setup</a><ul class='nav nav-list'><li class=''><a href="../Advanced_Setup/Create_A_Bootable_MicroSD_Card_From_Preinstalled_Binaries.html">Create A Bootable MicroSD Card From Preinstalled Binaries</a></li><li class='active'><a href="../Advanced_Setup/Create_A_Bootable_MicroSD_Card_From_Sources.html">Create A Bootable MicroSD Card From Sources</a></li><li class=''><a href="../Advanced_Setup/Compile_The_Linux_Kernel_And_The_Modules.html">Compile The Linux Kernel And The Modules</a></li><li class=''><a href="../Advanced_Setup/Compile_Android_From_Sources.html">Compile Android From Sources</a></li><li class=''><a href="../Advanced_Setup/UDOO_Boot_From_SATA.html">UDOO Boot From SATA</a></li><li class=''><a href="../Advanced_Setup/UDOO_Kernel_Update_Procedure.html">UDOO Kernel Update Procedure</a></li><li class=''><a href="../Advanced_Setup/UDOO_Usb_Debug.html">UDOO Usb Debug</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Connecting UDOO</a><ul class='nav nav-list'><li class=''><a href="../Connecting_UDOO/Connecting_Via_Serial_Cable.html">Connecting Via Serial Cable</a></li><li class=''><a href="../Connecting_UDOO/Find_IP_Address.html">Find IP Address</a></li><li class=''><a href="../Connecting_UDOO/Connecting_Via_SSH.html">Connecting Via SSH</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Linux</a><ul class='nav nav-list'><li class=''><a href="../Linux/Understanding_Linux_Software_Management_And_Installing.html">Understanding Linux Software Management And Installing</a></li><li class=''><a href="../Linux/Linux_Command_Line_Interface.html">Linux Command Line Interface</a></li><li class=''><a href="../Linux/Create_A_Virtual_Machine_For_UDOO_Development.html">Create A Virtual Machine For UDOO Development</a></li><li class=''><a href="../Linux/Install_Oracle_Java_Development_Kit_On_UDOO_Ubuntu.html">Install Oracle Java Development Kit On UDOO Ubuntu</a></li><li class=''><a href="../Linux/UDOO_Webserver.html">UDOO Webserver</a></li><li class=''><a href="../Linux/Program_Arduino_With_UDOO_IDE.html">Program Arduino With UDOO IDE</a></li><li class=''><a href="../Linux/Linux_GPIO_Manipulation.html">Linux GPIO Manipulation</a></li><li class=''><a href="../Linux/Install_A_Custom_Debian_Distro_With_Debootstrap.html">Install A Custom Debian Distro With Debootstrap</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Android</a><ul class='nav nav-list'><li class=''><a href="../Android/UDOO_Android_Boot_Walkthrough.html">UDOO Android Boot Walkthrough</a></li><li class=''><a href="../Android/Android_And_Arduino_Simple_Hello_World_Tutorial.html">Android And Arduino Simple Hello World Tutorial</a></li><li class=''><a href="../Android/Android_And_Arduino_On_UDOO_Bidirectional_Communication.html">Android And Arduino On UDOO Bidirectional Communication</a></li><li class=''><a href="../Android/UDOO_Configure_Ethernet_Under_Android.html">UDOO Configure Ethernet Under Android</a></li><li class=''><a href="../Android/How_To_Install_Gapps_On_UDOO_Running_Android.html">How To Install Gapps On UDOO Running Android</a></li><li class=''><a href="../Android/UDOO_Switch_Between_Adb_Debug_And_ADK_Connection.html">UDOO Switch Between Adb Debug And ADK Connection</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Arduino</a><ul class='nav nav-list'><li class=''><a href="../Arduino/UDOO_Install_The_Arduino_IDE.html">UDOO Install The Arduino IDE</a></li><li class=''><a href="../Arduino/Program_UDOO_Arduino_Processor_From_External_PC.html">Program UDOO Arduino Processor From External PC</a></li><li class=''><a href="../Arduino/UDOO_Programming_The_Embedded_Arduino_Microcontroller.html">UDOO Programming The Embedded Arduino Microcontroller</a></li><li class=''><a href="../Arduino/Arduino_Shields_With_UDOO.html">Arduino Shields With UDOO</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Communication Between The 2 Processors</a><ul class='nav nav-list'><li class=''><a href="../Communication_Between_The_2_Processors/UDOO_Seral_Libraries_Examples.html">UDOO Seral Libraries Examples</a></li><li class=''><a href="../Communication_Between_The_2_Processors/Interaction_Between_Linux_And_Arduino_On_UDOO.html">Interaction Between Linux And Arduino On UDOO</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Hardware & Accessories</a><ul class='nav nav-list'><li class=''><a href="../Hardware & Accessories/UDOO_GPIO_Pinout.html">UDOO GPIO Pinout</a></li><li class=''><a href="../Hardware & Accessories/IMX6_And_Sam3X_Communication.html">IMX6 And Sam3X Communication</a></li><li class=''><a href="../Hardware & Accessories/UDOO_Setup_lvds_panels.html">UDOO Setup lvds panels</a></li><li class=''><a href="../Hardware & Accessories/UDOO_Camera_Module.html">UDOO Camera Module</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Software & OS Distro</a><ul class='nav nav-list'><li class=''><a href="../Software_&_OS_Distro/Official_Distributions.html">Official Distributions</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Projects Examples</a><ul class='nav nav-list'><li class=''><a href="../Projects_Examples/Face_Recognition_And_Face_Tracking_Via_OpenCV_And_UDOO.html">Face Recognition And Face Tracking Via OpenCV And UDOO</a></li><li class=''><a href="../Projects_Examples/Remote_Metereological_Station_With_UDOO.html">Remote Metereological Station With UDOO</a></li><li class=''><a href="../Projects_Examples/DIY_NAS_With_Openmediavault_And_UDOO.html">DIY NAS With Openmediavault And UDOO</a></li></ul></li><li class=''><a href="../Serial_Libraries/index.html" class="folder">Serial Libraries</a><ul class='nav nav-list'><li class=''><a href="../Serial_Libraries/Java_Serial_Libraries.html">Java Serial Libraries</a></li><li class=''><a href="../Serial_Libraries/C_Serial_Libraries.html">C Serial Libraries</a></li><li class=''><a href="../Serial_Libraries/PHP_Serial_Libraries.html">PHP Serial Libraries</a></li><li class=''><a href="../Serial_Libraries/Python_Serial_Libraries.html">Python Serial Libraries</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Mods</a><ul class='nav nav-list'><li class=''><a href="../Mods/Mod_Your_UDOO_To_Improve_WiFi_Performances.html">Mod Your UDOO To Improve WiFi Performances</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">FAQ</a><ul class='nav nav-list'><li class=''><a href="../FAQ/Introductive.html">Introductive</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Troubleshooting</a><ul class='nav nav-list'><li class=''><a href="../Troubleshooting/Why_My_UDOO_Wont_Boot.html">Why My UDOO Wont Boot</a></li><li class=''><a href="../Troubleshooting/How_Can_I_Solve_My_HDMI_Issues.html">How Can I Solve My HDMI Issues</a></li><li class=''><a href="../Troubleshooting/How_Do_I_Set_Up_My_LVDS_Panel.html">How Do I Set Up My LVDS Panel</a></li></ul></li><li class=''><a href="#" class="aj-nav folder">Hackaton Survival Guide</a><ul class='nav nav-list'><li class=''><a href="../Hackaton_Survival_Guide/Mirroring_UDOOs_Desktop_on_your_PC_with_VNC_Remote_Desktop.html">Mirroring UDOOs Desktop on your PC with VNC Remote Desktop</a></li><li class=''><a href="../Hackaton_Survival_Guide/Programming_UDOOs_Arduino_from_your_PC.html">Programming UDOOs Arduino from your PC</a></li><li class=''><a href="../Hackaton_Survival_Guide/Useful_Resources.html">Useful Resources</a></li></ul></li></ul>

                <div class="sidebar-links">
                    
                        <!-- Links -->
                        <a href="http://www.udoo.org" target="_blank">Home</a><br><a href="http://www.udoo.org/downloads" target="_blank">Downloads</a><br><a href="http://www.udoo.org/tutorial" target="_blank">Tutorials</a><br><a href="http://www.udoo.org/forum" target="_blank">Forum</a><br>
                        <!-- Twitter -->
                        
                        <hr/>
                    
                    <p><small>Documentation generated by <a href="http://daux.io">Daux.io</a></small></p>
                </div>
            </div>
        </div>
        <div class="right-column  content-area col-sm-9">
            <div class="content-page">
                <article>
            <div class="page-header">
            <h1>Create A Bootable MicroSD Card From Sources            </h1>
        </div>
    
    <h2>Overview</h2>
<p>Note: The following instructions are referred to a Linux system.</p>
<p>A bootable SD card has 3 different elements:</p>
<ul>
<li>Kernel</li>
<li>U-Boot (Universal Bootloader)</li>
<li>File System (e.g: UDOObuntu)</li>
</ul>
<p>A possible way to create a bootable SD card consists in installing the elements separately from the binaries available on UDOO’ s website. Alternatively, it is possible to compile the source code in order to get the binaries.</p>
<p>This is especially useful for people that want to customize and improve the UDOO DUAL/QUAD environment and getting the newest kernel/u-boot updates. This way is not usually suitable for beginners.</p>
<p>The following steps are required when using an unformatted microSD card:</p>
<h2>Download Binaries</h2>
<p>Download all the necessary binaries that must be installed.</p>
<p>Create a development folder on Home:</p>
<pre><code class="language-bash">
mkdir udoo-dev


</code></pre>
<p>then move to the folder</p>
<pre><code class="language-bash">
cd udoo-dev

</code></pre>
<p>Download inside the “udoo-dev” folder the file system, the U-Boot file (u-boot.imx) for UDOO DUAL/QUAD from the binaries section of the website <a href="/other-resources/">http://www.udoo.org/other-resources/</a>. Once completed these steps, in “udoo-dev” folder there will be 3 binary files: File System, U-Boot and Kernel.</p>
<h2>Compile the Linux Kernel and the modules</h2>
<p>It’s possible to download the Kernel sources from the GitHub repository <a href="https://github.com/UDOOboard/linux_kernel">https://github.com/UDOOboard/linux_kernel</a>.</p>
<p>It could be prompted to install some packages in order to successfully compile the kernel on Linux.</p>
<p>E.g. in Ubuntu 14.04 it is necessary  to install the following packages:</p>
<pre><code class="language-bash">
sudo apt-get install build-essential ncurses-dev u-boot-tools git gcc-arm-linux-gnueabihf 

</code></pre>
<p>Download the latest kernel revision from GitHub:</p>
<pre><code class="language-bash">
git clone https://github.com/UDOOboard/linux_kernel

</code></pre>
<p>Move inside the folder linux_kernel:</p>
<pre><code class="language-bash">
cd linux_kernel

</code></pre>
<p>Set the default kernel configuration for UDOO DUAL/QUAD by running the command:</p>
<pre><code class="language-bash">
make ARCH=arm udoo_quad_dual_defconfig

</code></pre>
<p>At this point, it is possible, if you need, to edit the config (optional):</p>
<pre><code class="language-bash">
make ARCH=arm menuconfig

</code></pre>
<p>Start compiling the Kernel, modules and dtb files:</p>
<pre><code class="language-bash">
make -j4 CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm zImage modules dtbs


</code></pre>
<p>(This operation could take up to 20 minutes, depending on the PC used) The compiled Binary (zImage) will now be available in the arch/arm/boot/ folder.</p>
<p>Modules and firmwares will be installed later, you can remain in this kernel folder.</p>
<h2>Preparing the partitions on the SD card</h2>
<p>Insert the microSD card in the card reader.</p>
<p>Launch gparted:</p>
<pre><code class="language-bash">
sudo gparted

</code></pre>
<p>Select the right microSD label from the drop down menu</p>
<p>NOTE: Be sure you’ re using the correct label; use of the wrong device identifier could result in the loss of all data on the Hard Drive of the host PC used. e.g.  /dev/sdc</p>
<p>Unmount and delete the existing microSD partitions (If necessary, create a partition table: Select from the top menu: Device → Create Partition Table... → Apply)</p>
<p>Create two new partition with the following parameters and press Add.</p>
<pre><code class="language-bash">
Free space preceding (MiB): 5
New size (MiB): 50
Free space following (MiB): 0
Create as: Primary partition
label: boot
File system: fat16

Free space preceding (MiB): 0
New size (MiB): based to the SD size
Free space following (MiB): 0
Create as: Primary partition
label: rootfs
File system: ext4

</code></pre>
<p>Press the green V form, wait for the partition to be done and exit gparted.</p>
<h2>Copy the files on the SD card File System</h2>
<p>Note: Always remember to replace the strings inside the brackets with the right filenames.</p>
<p>Mount the just-created partitions and then extract the tar.gz file containing the filesystem inside the microSD card with the following command:</p>
<pre><code class="language-bash">
sudo tar -xzvpf &lt;NAME_OF_TAR_FS&gt; -C /media/&lt;user_name&gt;/rootfs/

</code></pre>
<p>(This operation could take up to 30 minutes)</p>
<p>Kernel Image:</p>
<p>Copy the kernel binary and device tree files inside the microSD card boot folder by using the following commands:</p>
<pre><code class="language-bash">
cp arch/arm/boot/zImage /media/&lt;user_name&gt;/boot/
mkdir /media/&lt;user_name&gt;/boot/dts/
cp arch/arm/boot/dts/imx*udoo*.dtb /media/&lt;user_name&gt;/boot/dts/

</code></pre>
<h3>Installing kernel modules</h3>
<p>Remove the previous modules:</p>
<pre><code class="language-bash">
sudo rm -rv /media/&lt;user_name&gt;/rootfs/lib/modules/*

</code></pre>
<p>Install the new firmwares and modules (from the kernel folder):</p>
<pre><code class="language-bash">
make firmware_install modules_install INSTALL_MOD_PATH=/media/&lt;user_name&gt;/rootfs/ CROSS_COMPILE=arm-linux-gnueabihf- ARCH=arm

</code></pre>
<h3>Compiling and Installing U-Boot</h3>
<p>Download the latest U-Boot revision from GitHub:</p>
<pre><code class="language-bash">
git clone https://github.com/UDOOboard/uboot-imx

</code></pre>
<p>Move inside the folder uboot-imx:</p>
<pre><code class="language-bash">
cd uboot-imx

</code></pre>
<p>To build the U-Boot for UDOO Quad/Dual, use the 2015.10.fslc-qdl branch. This branch is based on Freescale Community's U-Boot (uboot-fslc) version 2015.10.</p>
<pre><code class="language-bash">
git checkout 2015.10.fslc-qdl

</code></pre>
<p>The build can be started with:</p>
<pre><code class="language-bash">
ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make udoo_qdl_config
ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- make

</code></pre>
<p>The produced files, SPL and u-boot.img, can be used to boot both Quad and Dual boards.</p>
<p>Unmount all the Micro SD partitions:</p>
<pre><code class="language-bash">
sudo umount /dev/&lt;user_name&gt;/boot
sudo umount /dev/&lt;user_name&gt;/rootfs

</code></pre>
<p>NOTE: Be sure you’ re using the correct device filename (/dev/sdX or /dev/mmcblkX); use of the wrong device identifier could result in the loss of all data on the Hard Drive of the host PC used.</p>
<p>Double check the filename of your device with command:</p>
<pre><code class="language-bash">
lsblk

</code></pre>
<p>Flash the files in the SD (e.g. /dev/sdb) card with:</p>
<pre><code class="language-bash">
sudo dd if=SPL of=/dev/mmcblk0 bs=1K seek=1
sudo dd if=u-boot.img of=/dev/mmcblk0 bs=1K seek=69

</code></pre>
<p>The microSD card is now ready. Simply insert it in UDOO DUAL/QUAD’s microSD Card slot and boot the system.</p>

        <nav>
        <ul class="pager">
            <li><a href="../Advanced_Setup/Create_A_Bootable_MicroSD_Card_From_Preinstalled_Binaries.html">Previous</a></li>            <li><a href="../Advanced_Setup/Compile_The_Linux_Kernel_And_The_Modules.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    

    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>
    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-40057783-1', 'auto', {
            'allowLinker': true});
      ga('send', 'pageview');
    </script>
</body>
</html>
